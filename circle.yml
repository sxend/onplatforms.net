machine:
  services:
    - docker
dependencies:
  pre:
    - nvm install v6.9.1
    - nvm alias default v6.9.1
    - mkdir -p ~/.aws
    - envsubst < .aws/credentials.template > ~/.aws/credentials
    - envsubst < .aws/config.template > ~/.aws/config
  override:
    - sbt "set version := \"b${CIRCLE_BUILD_NUM}-${CIRCLE_SHA1}\"" assembly
    - aws s3 cp ./target/scala-2.11/platform.jar s3://internal-storage.onplatforms.net/b${CIRCLE_BUILD_NUM}-${CIRCLE_SHA1}/